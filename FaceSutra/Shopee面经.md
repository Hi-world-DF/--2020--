# Shopee后端开发面经1

> 问题来源：牛客网友分享的面经

#### 1、TCP四次挥手

答：

1）客户端进程发出连接释放报文，并且停止发送数据。释放数据报文首部，FIN=1，其序列号为seq=u（等于前面传过来的数据的最后一个字节的序号加1），此时，客户端进入FIN-WAIT-1（终止等待1）状态。
2）服务器收到连接释放报文，发出确认报文，ACK=1，ack=u+1，并且带上自己的序列号seq=v，此时，服务端就进入了CLOSE-WAIT（关闭等待）状态。即客户端已经没有数据要发送了，但是服务器若发送数据，客户端依然要接受。这个状态还要持续一段时间，也就是整个CLOSE-WAIT状态持续的时间。
3）客户端收到服务器的确认请求后，此时，客户端就进入FIN-WAIT-2（终止等待2）状态，等待服务器发送连接释放报文（在这之前还需要接受服务器发送的最后的数据）。
4）服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN=1，ack=u+1，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为seq=w，此时，服务器就进入了LAST-ACK（最后确认）状态，等待客户端的确认。
5）客户端收到服务器的连接释放报文后，必须发出确认，ACK=1，ack=w+1，而自己的序列号是seq=u+1，此时，客户端就进入了TIME-WAIT（时间等待）状态。注意此时TCP连接还没有释放，必须经过2∗∗MSL（最长报文段寿命）的时间后，当客户端撤销相应的TCB后，才进入CLOSED状态。
6）服务器只要收到了客户端发出的确认，立即进入CLOSED状态。

**【扩展问题】**

* **三次握手的过程**

  （1）第一次握手：建立连接时，客户端发送syn包（syn=x）到服务器，并进入SYN_SENT状态，等待服务器确认；SYN：同步序列编号（Synchronize Sequence Numbers）。

  （2）第二次握手：服务器收到syn包，必须确认客户的SYN（ack=x+1），同时自己也发送一个SYN包（syn=y），即SYN+ACK包，此时服务器进入SYN_RECV状态；

  （3）第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=y+1），此包发送完毕，客户端和服务器进入ESTABLISHED（TCP连接成功）状态，完成三次握手。

* **为什么连接的时候是三次握手，关闭的时候却是四次握手？**

  因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，"你发的FIN报文我收到了"。只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。

* **为什么不能用两次握手进行连接？**

  3次握手完成两个重要的功能，既要双方做好发送数据的准备工作(双方都知道彼此已准备好)，也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。

* **如果已经建立了连接，但是客户端突然出现故障了怎么办？**

  TCP还设有一个保活计时器，显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。服务器每收到一次客户端的请求后都会重新复位这个计时器，时间通常是设置为2小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个探测报文段，以后每隔75秒钟发送一次。若一连发送10个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。

#### 2、TIME_WAIT, CLOSE_WAIT 

答：



**【扩展问题】**

#### 3、初始序列号是什么，有什么作用。 

答：

**【扩展问题】**

#### 4、TCP怎么实现可靠 

答：

**【扩展问题】**

#### 5、UDP能实现可靠性传输吗，怎么实现？ 

答：

**【扩展问题】**

#### 6、HTTPS连接流程 

答：

**【扩展问题】**

#### 7、HTTPS为什么要混合使用非对称加密和对称加密 

答：

**【扩展问题】**

#### 8、数字签名原理 

答：

**【扩展问题】**

#### 9、进程线程的区别，线程共享进程的什么资源，进程独自占有什么资源 

答：

**【扩展问题】**

#### 10、fork的时候子进程还拥有父进程的文件描述符吗 

答：

**【扩展问题】**

#### 11、僵尸进程/孤儿进程 

答：

**【扩展问题】**

#### 12、虚拟内存是什么 

答：

**【扩展问题】**

#### 13、内核空间用户空间 

答：

**【扩展问题】**

#### 14、几种IO模型了解多少 

答：

**【扩展问题】**

#### 15、同步非阻塞模型是怎么样的 

答：

**【扩展问题】**

#### 16、select，poll，epoll区别 

答：

**【扩展问题】**

#### 17、索引的类型 

答：

**【扩展问题】**

#### 18、二级索引回表的过程 

答：

**【扩展问题】**

#### 19、覆盖索引是什么 

答：

**【扩展问题】**

#### 20、MVCC是什么，实现了什么隔离级别 

答：

**【扩展问题】**

#### 21、redis基本对象有哪几种 

答：

**【扩展问题】**

#### 22、zset底层实现 

答：

**【扩展问题】**

#### 23、为什么zset要用跳跃表和哈希表

答：

**【扩展问题】**

#### 24、topK几种实现 

答：

**【扩展问题】**

#### 25、算法题：二分查找左边界 

答：

**【扩展问题】**

#### 26、反问

答：

**【扩展问题】**